{% extends "loc_dashboard_base.html" %}

{% block title %}<title>Table report</title> {% endblock %}

{% block chart %}
<section>
    {% block chartheader %}
        <form action="{% url 'tabular_report' %}" data-url="{% url 'users_in_group' %}" id="CreateTabularReport">
            {% csrf_token %}
            {% include "report_header.html" %}
        </form>
    {% endblock %}

    {% block chartcontent %}     
        <div class="table-responsive">
            <table id="ajaxtables" class="table table-striped table-bordered" id="reporttable" data-toggle="table" data-show-export="true" data-show-print="true"  
            data-pagination="true" data-page-list="[10, 25, 50, 100, ALL]" data-smart-display="true" data-sort-order="asc" 
            data-search="true" data-show-refresh="true" data-sortable="true" data-sticky-header="true">
                <thead>
                    <tr>
                        <th id="report-title" class="Theading text-center fw-bold fs-5" colspan="6">
                            User Position Tracking Report<br>
                            <span class="fw-normal">for {{ groupname }}</span><br>
                            <span class="fw-light">From {{ start_date }} to {{ end_date }}</span>
                        </th>
                    </tr>
                    <tr>
                        <th data-field="date" data-sortable="true" data-order="true" data-searchable="true">Date</th>
                        <th data-field="user" data-sortable="true" data-order="true">User</th>
                        <th data-field="time" data-sortable="true" data-order="true">Time</th>
                        <th data-field="lat" data-sortable="true" data-order="true">Latitude</th>
                        <th data-field="long" data-sortable="true" data-order="true">Longitude</th>
                        <th data-field="accu" data-sortable="true" data-order="true">Accuracy(m)</th>
                    </tr>
                </thead>
                <tbody id="ajaxtable">
                    {% for det in available_positions %}
                        <tr>
                            <td>{{ det.LocAppPos_Date|date:"d/m/Y" }}</td>  
                            <td>{{ det.LocAppPos_user }}</td>  
                            <td>{{ det.LocAppPos_timestamp|date:"H:i" }}</td> 
                            <td>{{ det.LocAppPos_latitude }}</td>  
                            <td>{{ det.LocAppPos_longitude }}</td>  
                            <td>{{ det.LocAppPos_accuracy }}</td>  
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="6" class="text-center">No positions available for the selected date range.</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% endblock %}
</section>
{% endblock %}
